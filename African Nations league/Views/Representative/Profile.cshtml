@model African_Nations_league.Controllers.RepresentativeProfileViewModel
@{
    ViewData["Title"] = "My Profile";
}

<div class="row">
    <div class="col-md-3">
        @await Html.PartialAsync("_RepMenu")
    </div>
    <div class="col-md-9">
        <h2>Profile</h2>

        <div class="card mb-3">
            <div class="card-body d-flex">
                @{
                    var flag = Model.Team?.FlagUrl ?? Model.User?.TeamFlag ?? "";
                    var teamName = Model.Team?.TeamName ?? Model.User?.TeamName ?? "No team";
                }
                <img src="@flag" alt="@teamName" style="width:100px;height:60px;margin-right:15px" onerror="this.src='/images/placeholder-flag.png';" />

                <div>
                    <h4>@Model.User.FullName</h4>
                    <div><strong>Email:</strong> @Model.User.Email</div>
                    <div><strong>Phone:</strong> @Model.User.PhoneNumber</div>
                    <div><strong>Role:</strong> @Model.User.Role</div>
                    <div><strong>Manager:</strong> @Model.User.ManagerName</div>
                    <div><strong>Team:</strong> @teamName</div>
                    <div><strong>Team rating:</strong> @(Model.Team?.TeamRating ?? Model.User?.TeamRating ?? 0)</div>
                </div>
            </div>
        </div>

        <h4>Squad</h4>
        <div class="row">
            @if ((Model.Team?.Players?.Any() ?? false) || (Model.User?.Squad?.Any() ?? false))
            {
                var squad = Model.Team?.Players?.Any() == true ? Model.Team.Players : Model.User.Squad;
                foreach (var p in squad)
                {
                    <div class="col-md-3 mb-2">
                        <div class="card">
                            <div class="card-body text-center">
                                <img src="@p.ImagePath" style="width:80px;height:80px" onerror="this.src='/images/placeholder-player.png';" />
                                <div>@p.PlayerName</div>
                                <div>@p.Position (@p.DetailedPosition)</div>
                                <div>Rating: @p.Rating</div>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="col-12">No players available.</div>
            }
        </div>

        <div class="mt-3">
            <a asp-action="EditProfile" class="btn btn-primary">Edit profile</a>

            <form asp-action="DeleteProfile" method="post" class="d-inline" onsubmit="return confirm('Are you sure you want to delete your profile?');">
                @Html.AntiForgeryToken()
                <button type="submit" class="btn btn-danger">Delete account</button>
            </form>
        </div>
    </div>
</div>
